[
    {
        "question_id": 201,
        "question_example": "Sell-in trend by month (cases and value)",
        "question_complexity": "simple",
        "question_type": "Sell-in trend by month (cases and value)",
        "question_description": "Track monthly sell-in cases and invoice value for a specific product slice to understand seasonality and channel dynamics.",
        "question_sql": "SELECT period_id, SUM(si_invoices_cases) AS si_cases, SUM(si_invoices_value_lcl) AS si_value FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly totals of sell-in cases and value for the slice.",
        "question_sql_template": "SELECT period_id, SUM(si_invoices_cases) AS si_cases, SUM(si_invoices_value_lcl) AS si_value FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Ensure a valid category\u2013flavour\u2013channel\u2013location combo. Prefer STORE for full coverage. Flavour must match category (Cola\u2192CSD, Apple\u2192JUICE, Mineral/Natural\u2192WATER)."
    },
    {
        "question_id": 202,
        "question_example": "Sell-in spike months (value > threshold)",
        "question_complexity": "simple",
        "question_type": "Sell-in spike months (value > threshold)",
        "question_description": "Identify months with unusually high sell-in value to investigate drivers (promos, seasonality, distribution shifts).",
        "question_sql": "SELECT period_id, SUM(si_invoices_value_lcl) AS si_value FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id HAVING si_value > 150000 ORDER BY si_value DESC;",
        "answer_template": "Months where sell-in value exceeds the threshold, highest first.",
        "question_sql_template": "SELECT period_id, SUM(si_invoices_value_lcl) AS si_value FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id HAVING si_value > {{value_threshold}} ORDER BY si_value DESC;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            },
            {
                "name": "value_threshold",
                "type": "numeric",
                "example": 150000
            }
        ],
        "hint": "Pick a realistic value_threshold (e.g., 100000\u2013300000 for STORE; lower for DC). Validate the slice exists before running."
    },
    {
        "question_id": 203,
        "question_example": "Net revenue trend by month",
        "question_complexity": "simple",
        "question_type": "Net revenue trend by month",
        "question_description": "Monitor monthly net revenue performance for a slice to assess growth and seasonality.",
        "question_sql": "SELECT period_id, SUM(si_net_revenue_value_lcl) AS net_rev FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly net revenue totals for the selected slice.",
        "question_sql_template": "SELECT period_id, SUM(si_net_revenue_value_lcl) AS net_rev FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Use a valid slice and check coverage across months; channel 45 often has higher volumes."
    },
    {
        "question_id": 204,
        "question_example": "Net revenue YoY by month (Jan\u2013Sep)",
        "question_complexity": "moderate",
        "question_type": "Net revenue YoY by month (Jan\u2013Sep)",
        "question_description": "Compare net revenue by month across 2024 vs 2025 for Jan\u2013Sep to understand YoY momentum.",
        "question_sql": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, SUM(si_net_revenue_value_lcl) AS net_rev FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id) SELECT a.mm, a.net_rev AS rev_2024, b.net_rev AS rev_2025, (b.net_rev - a.net_rev)*1.0/a.net_rev AS yoy FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "answer_template": "Per month Jan\u2013Sep: 2024 vs 2025 net revenue and YoY %.",
        "question_sql_template": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, SUM(si_net_revenue_value_lcl) AS net_rev FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id) SELECT a.mm, a.net_rev AS rev_2024, b.net_rev AS rev_2025, (b.net_rev - a.net_rev)*1.0/a.net_rev AS yoy FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "YoY uses months Jan\u2013Sep available in both 2024 and 2025. Prefer STORE slices with full coverage."
    },
    {
        "question_id": 205,
        "question_example": "Returns rate summary (value-weighted)",
        "question_complexity": "simple",
        "question_type": "Returns rate summary (value-weighted)",
        "question_description": "Assess overall returns rate for the slice by dividing returns value by invoice value.",
        "question_sql": "SELECT SUM(si_returns_value_lcl) AS ret_value, SUM(si_invoices_value_lcl) AS inv_value, (SUM(si_returns_value_lcl)*1.0/SUM(si_invoices_value_lcl)) AS ret_rate FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE';",
        "answer_template": "Single-row summary: returns value, invoice value, and returns rate.",
        "question_sql_template": "SELECT SUM(si_returns_value_lcl) AS ret_value, SUM(si_invoices_value_lcl) AS inv_value, (SUM(si_returns_value_lcl)*1.0/SUM(si_invoices_value_lcl)) AS ret_rate FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}';",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Returns rate is value-weighted (typical ~1\u20133%). Ensure invoices are non-zero for stability."
    },
    {
        "question_id": 206,
        "question_example": "High returns months (rate > threshold)",
        "question_complexity": "simple",
        "question_type": "High returns months (rate > threshold)",
        "question_description": "Find months where returns rate exceeds a threshold to prioritize root-cause analysis (quality, logistics).",
        "question_sql": "SELECT period_id, (SUM(si_returns_value_lcl)*1.0/SUM(si_invoices_value_lcl)) AS ret_rate FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id HAVING ret_rate > 0.02 ORDER BY ret_rate DESC;",
        "answer_template": "Months with returns rate higher than threshold, sorted by rate.",
        "question_sql_template": "SELECT period_id, (SUM(si_returns_value_lcl)*1.0/SUM(si_invoices_value_lcl)) AS ret_rate FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id HAVING ret_rate > {{ret_rate_threshold}} ORDER BY ret_rate DESC;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            },
            {
                "name": "ret_rate_threshold",
                "type": "numeric",
                "example": 0.02
            }
        ],
        "hint": "ret_rate_threshold is 0\u20131 (0.02=2%). Low invoice months can inflate rates; pick robust slices."
    },
    {
        "question_id": 207,
        "question_example": "Gross profit and margin trend",
        "question_complexity": "simple",
        "question_type": "Gross profit and margin trend",
        "question_description": "Track gross profit and margin over time to detect erosion or improvements.",
        "question_sql": "SELECT period_id, SUM(si_gross_profit_value_lcl) AS gp, SUM(si_net_revenue_value_lcl) AS nr, (SUM(si_gross_profit_value_lcl)*1.0/SUM(si_net_revenue_value_lcl)) AS gp_margin FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly gross profit and margin for the slice.",
        "question_sql_template": "SELECT period_id, SUM(si_gross_profit_value_lcl) AS gp, SUM(si_net_revenue_value_lcl) AS nr, (SUM(si_gross_profit_value_lcl)*1.0/SUM(si_net_revenue_value_lcl)) AS gp_margin FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Gross margin \u2248 35% baseline; verify non-zero net revenue and review promo depth if margin dips."
    },
    {
        "question_id": 208,
        "question_example": "Low margin months (margin < threshold)",
        "question_complexity": "simple",
        "question_type": "Low margin months (margin < threshold)",
        "question_description": "Highlight months where gross margin drops below a target to trigger pricing/cost actions.",
        "question_sql": "SELECT period_id, (SUM(si_gross_profit_value_lcl)*1.0/SUM(si_net_revenue_value_lcl)) AS gp_margin FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id HAVING gp_margin < 0.30 ORDER BY gp_margin;",
        "answer_template": "Months with margin below threshold, lowest first.",
        "question_sql_template": "SELECT period_id, (SUM(si_gross_profit_value_lcl)*1.0/SUM(si_net_revenue_value_lcl)) AS gp_margin FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id HAVING gp_margin < {{margin_threshold}} ORDER BY gp_margin;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            },
            {
                "name": "margin_threshold",
                "type": "numeric",
                "example": 0.3
            }
        ],
        "hint": "Set margin_threshold in 0\u20131 (e.g., 0.30). Investigate pricing/promo periods for low margins."
    },
    {
        "question_id": 209,
        "question_example": "ASP (weighted) trend by month",
        "question_complexity": "simple",
        "question_type": "ASP (weighted) trend by month",
        "question_description": "Track average selling price (invoice value per case) over time to spot pricing shifts and inflation.",
        "question_sql": "SELECT period_id, (SUM(si_invoices_value_lcl)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS asp FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly weighted ASP for the selected slice.",
        "question_sql_template": "SELECT period_id, (SUM(si_invoices_value_lcl)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS asp FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "ASP = invoice value \u00f7 cases. Expect ~+6% inflation in 2025 vs 2024; ensure non-zero invoices."
    },
    {
        "question_id": 210,
        "question_example": "ASP YoY by month (Jan\u2013Sep)",
        "question_complexity": "moderate",
        "question_type": "ASP YoY by month (Jan\u2013Sep)",
        "question_description": "Compare ASP across 2024 vs 2025 for Jan\u2013Sep to quantify realized price inflation.",
        "question_sql": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, (SUM(si_invoices_value_lcl)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS asp FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id) SELECT a.mm, a.asp AS asp_2024, b.asp AS asp_2025, (b.asp - a.asp)*1.0/a.asp AS yoy FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "answer_template": "Per month Jan\u2013Sep: ASP 2024 vs 2025 and YoY %.",
        "question_sql_template": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, (SUM(si_invoices_value_lcl)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS asp FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id) SELECT a.mm, a.asp AS asp_2024, b.asp AS asp_2025, (b.asp - a.asp)*1.0/a.asp AS yoy FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "YoY ASP compares Jan\u2013Sep. Requires months in both years; prefer STORE slices."
    },
    {
        "question_id": 211,
        "question_example": "Sell-out trend by month (units and value)",
        "question_complexity": "simple",
        "question_type": "Sell-out trend by month (units and value)",
        "question_description": "Track monthly sell-out performance for the slice to validate demand and promo impacts.",
        "question_sql": "SELECT period_id, SUM(so_units) AS so_units, SUM(so_value_lcl) AS so_value FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly totals of sell-out units and value for the slice.",
        "question_sql_template": "SELECT period_id, SUM(so_units) AS so_units, SUM(so_value_lcl) AS so_value FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Sell-out varies with seasonality and promos; channel 45 tends to be higher; validate slice exists."
    },
    {
        "question_id": 212,
        "question_example": "Price realization vs list by month",
        "question_complexity": "simple",
        "question_type": "Price realization vs list by month",
        "question_description": "Compare average net price vs list price to understand realized discounting over time.",
        "question_sql": "SELECT period_id, AVG(retail_price_lcl) AS avg_list, AVG(net_price_lcl) AS avg_net, (AVG(net_price_lcl)*1.0/AVG(retail_price_lcl)) AS realization FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly average list price, net price, and realization ratio.",
        "question_sql_template": "SELECT period_id, AVG(retail_price_lcl) AS avg_list, AVG(net_price_lcl) AS avg_net, (AVG(net_price_lcl)*1.0/AVG(retail_price_lcl)) AS realization FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Realization = net/list; promo-active months usually lower. Ensure sufficient mix of promo/non-promo."
    },
    {
        "question_id": 213,
        "question_example": "Inventory health summary (avg DoS and low DoS count)",
        "question_complexity": "simple",
        "question_type": "Inventory health summary (avg DoS and low DoS count)",
        "question_description": "Summarize days of supply and frequency of low coverage to assess stock risk.",
        "question_sql": "SELECT AVG(days_of_supply) AS avg_dos, SUM(CASE WHEN days_of_supply < 10 THEN 1 ELSE 0 END) AS low_dos_rows FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE';",
        "answer_template": "Single-row summary: average DoS and count of rows below threshold.",
        "question_sql_template": "SELECT AVG(days_of_supply) AS avg_dos, SUM(CASE WHEN days_of_supply < {{dos_threshold}} THEN 1 ELSE 0 END) AS low_dos_rows FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}';",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            },
            {
                "name": "dos_threshold",
                "type": "numeric",
                "example": 10
            }
        ],
        "hint": "Low DoS (<10) signals risk. Interpret alongside seasonality and channel; DC coverage is sparser."
    },
    {
        "question_id": 214,
        "question_example": "Low DoS months (avg DoS < threshold)",
        "question_complexity": "simple",
        "question_type": "Low DoS months (avg DoS < threshold)",
        "question_description": "Identify months with low average days of supply to trigger replenishment actions.",
        "question_sql": "SELECT period_id, AVG(days_of_supply) AS avg_dos FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id HAVING avg_dos < 10 ORDER BY avg_dos;",
        "answer_template": "Months with average DoS below threshold, sorted ascending.",
        "question_sql_template": "SELECT period_id, AVG(days_of_supply) AS avg_dos FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id HAVING avg_dos < {{dos_threshold}} ORDER BY avg_dos;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            },
            {
                "name": "dos_threshold",
                "type": "numeric",
                "example": 10
            }
        ],
        "hint": "Choose a realistic dos_threshold (e.g., 10). Watch for seasonal dips in coverage."
    },
    {
        "question_id": 215,
        "question_example": "Promo incidence and depth summary",
        "question_complexity": "simple",
        "question_type": "Promo incidence and depth summary",
        "question_description": "Summarize promotion activity and average discount depth when active for the slice.",
        "question_sql": "SELECT SUM(promo_active_flag) AS promo_rows, COUNT(*) AS total_rows, AVG(CASE WHEN promo_active_flag = 1 THEN discount_pct END) AS avg_disc_when_active FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE';",
        "answer_template": "Single-row summary of promo months/count and average discount when active.",
        "question_sql_template": "SELECT SUM(promo_active_flag) AS promo_rows, COUNT(*) AS total_rows, AVG(CASE WHEN promo_active_flag = 1 THEN discount_pct END) AS avg_disc_when_active FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}';",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Promo incidence higher in channel 45 and CSD. Depth (discount_pct) only when promo_active_flag=1."
    },
    {
        "question_id": 216,
        "question_example": "Promo vs non-promo sell-out (avg units)",
        "question_complexity": "moderate",
        "question_type": "Promo vs non-promo sell-out (avg units)",
        "question_description": "Compare average sell-out units during promo-active vs non-active periods to estimate uplift.",
        "question_sql": "SELECT promo_active_flag, AVG(so_units) AS avg_so_units, COUNT(*) AS n FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY promo_active_flag ORDER BY promo_active_flag;",
        "answer_template": "Two rows (0/1) with average sell-out units and counts; uplift = (avg1 - avg0)/avg0.",
        "question_sql_template": "SELECT promo_active_flag, AVG(so_units) AS avg_so_units, COUNT(*) AS n FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY promo_active_flag ORDER BY promo_active_flag;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Requires both promo_active_flag=0 and 1 in the slice; otherwise uplift comparison is not meaningful."
    },
    {
        "question_id": 217,
        "question_example": "Market share trend by month (units/value)",
        "question_complexity": "simple",
        "question_type": "Market share trend by month (units/value)",
        "question_description": "Track average unit and value share over time and frequency of top-1 rank.",
        "question_sql": "SELECT period_id, AVG(share_units_pct) AS avg_share_u, AVG(share_value_pct) AS avg_share_v, SUM(CASE WHEN share_rank = 1 THEN 1 ELSE 0 END) AS top1_rows FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly average unit/value share and count of top-1 rank rows.",
        "question_sql_template": "SELECT period_id, AVG(share_units_pct) AS avg_share_u, AVG(share_value_pct) AS avg_share_v, SUM(CASE WHEN share_rank = 1 THEN 1 ELSE 0 END) AS top1_rows FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Share metrics are proportions (0\u20131). Unit vs value share can diverge; DC slices may be sparse."
    },
    {
        "question_id": 218,
        "question_example": "Unit share YoY by month (Jan\u2013Sep)",
        "question_complexity": "moderate",
        "question_type": "Unit share YoY by month (Jan\u2013Sep)",
        "question_description": "Compare average unit share across 2024 vs 2025 (Jan\u2013Sep) to understand competitive shifts.",
        "question_sql": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, AVG(share_units_pct) AS share_u FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id) SELECT a.mm, a.share_u AS share_2024, b.share_u AS share_2025, (b.share_u - a.share_u) AS yoy_delta FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "answer_template": "Per month Jan\u2013Sep: unit share 2024 vs 2025 and absolute delta.",
        "question_sql_template": "WITH base AS (SELECT period_id, CAST(substr(CAST(period_id AS TEXT),1,4) AS INT) AS yy, CAST(substr(CAST(period_id AS TEXT),5,2) AS INT) AS mm, AVG(share_units_pct) AS share_u FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id) SELECT a.mm, a.share_u AS share_2024, b.share_u AS share_2025, (b.share_u - a.share_u) AS yoy_delta FROM base a JOIN base b ON a.mm = b.mm AND a.yy = 2024 AND b.yy = 2025 WHERE a.mm BETWEEN 1 AND 9 ORDER BY a.mm;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "YoY unit share uses Jan\u2013Sep. Small slices can be noisy; prefer STORE for coverage."
    },
    {
        "question_id": 219,
        "question_example": "Sell-in vs sell-out alignment by month",
        "question_complexity": "moderate",
        "question_type": "Sell-in vs sell-out alignment by month",
        "question_description": "Compare sell-in cases vs sell-out units by month to detect pipeline imbalances.",
        "question_sql": "SELECT period_id, SUM(si_invoices_cases) AS si_cases, SUM(so_units) AS so_units, (SUM(so_units)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS sell_through FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly sell-in vs sell-out with sell-through ratio (so_units / si_cases).",
        "question_sql_template": "SELECT period_id, SUM(si_invoices_cases) AS si_cases, SUM(so_units) AS so_units, (SUM(so_units)*1.0/NULLIF(SUM(si_invoices_cases),0)) AS sell_through FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Sell-through = so_units \u00f7 si_cases; large gaps may indicate inventory build or depletion."
    },
    {
        "question_id": 220,
        "question_example": "Orders vs invoices conversion by month",
        "question_complexity": "moderate",
        "question_type": "Orders vs invoices conversion by month",
        "question_description": "Measure conversion from ordered cases to invoiced cases as a proxy for service level.",
        "question_sql": "SELECT period_id, SUM(si_orders_cases) AS orders, SUM(si_invoices_cases) AS invoices, (SUM(si_invoices_cases)*1.0/NULLIF(SUM(si_orders_cases),0)) AS fill_rate FROM sales_data WHERE category = 'CSD' AND product_flavour = 'Cola' AND distribution_channel = 45 AND location_type = 'STORE' GROUP BY period_id ORDER BY period_id;",
        "answer_template": "Monthly orders vs invoices and fill rate (invoices / orders).",
        "question_sql_template": "SELECT period_id, SUM(si_orders_cases) AS orders, SUM(si_invoices_cases) AS invoices, (SUM(si_invoices_cases)*1.0/NULLIF(SUM(si_orders_cases),0)) AS fill_rate FROM sales_data WHERE category = '{{category}}' AND product_flavour = '{{product_flavour}}' AND distribution_channel = {{distribution_channel}} AND location_type = '{{location_type}}' GROUP BY period_id ORDER BY period_id;",
        "question_inputs": [
            {
                "name": "category",
                "type": "categorical",
                "example": "CSD, JUICE, WATER",
                "unique_values": [
                    "CSD",
                    "JUICE",
                    "WATER"
                ]
            },
            {
                "name": "product_flavour",
                "type": "categorical",
                "example": "Apple, Berry, Cola",
                "unique_values": [
                    "Apple",
                    "Berry",
                    "Cola",
                    "Grape",
                    "Lime",
                    "Mineral",
                    "Natural",
                    "Orange",
                    "Tropical",
                    "Unknown"
                ]
            },
            {
                "name": "distribution_channel",
                "type": "categorical",
                "example": "20, 45",
                "unique_values": [
                    20,
                    45
                ]
            },
            {
                "name": "location_type",
                "type": "categorical",
                "example": "STORE, DC",
                "unique_values": [
                    "STORE",
                    "DC"
                ]
            }
        ],
        "hint": "Fill rate = invoices \u00f7 orders; typical range ~0.92\u20131.00. Low rates may indicate service issues."
    }
]